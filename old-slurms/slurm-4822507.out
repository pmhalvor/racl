Starting job 4822507 on c7-1 at Wed Jan 12 22:28:04 CET 2022

The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) StdEnv
submission directory: /cluster/home/pmhalvor/nlp/msc/RACL
core file size          (blocks, -c) unlimited
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 1543736
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 131072
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 1543736
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Currently Loaded Modules:
  1) StdEnv                                        (S)
  2) GCCcore/8.2.0
  3) zlib/1.2.11-GCCcore-8.2.0                     (H)
  4) binutils/2.31.1-GCCcore-8.2.0                 (H)
  5) GCC/8.2.0-2.31.1
  6) CUDA/10.1.105-GCC-8.2.0-2.31.1
  7) gcccuda/2019a
  8) NCCL/2.4.8-gcccuda-2019a
  9) hpcx/2.5
 10) OpenMPI/3.1.3-gcccuda-2019a
 11) OpenBLAS/0.3.5-GCC-8.2.0-2.31.1
 12) gompic/2019a
 13) FFTW/3.3.8-gompic-2019a
 14) ScaLAPACK/2.0.2-gompic-2019a-OpenBLAS-0.3.5
 15) fosscuda/2019a
 16) bzip2/1.0.6-GCCcore-8.2.0                     (H)
 17) ncurses/6.1-GCCcore-8.2.0                     (H)
 18) libreadline/8.0-GCCcore-8.2.0                 (H)
 19) XZ/5.2.4-GCCcore-8.2.0                        (H)
 20) GMP/6.1.2-GCCcore-8.2.0                       (H)
 21) libffi/3.2.1-GCCcore-8.2.0                    (H)
 22) Python/3.7.2-GCCcore-8.2.0
 23) SciPy-bundle/2019.03-fosscuda-2019a
 24) Szip/2.1.1-GCCcore-8.2.0                      (H)
 25) HDF5/1.10.5-gompic-2019a
 26) h5py/2.9.0-fosscuda-2019a
 27) cuDNN/7.6.4.38-gcccuda-2019a
 28) TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2

  Where:
   H:  Hidden Module
   S:  Module is Sticky, requires --force to unload or purge

 

--------------------------------------------------------------------------
A process has executed an operation involving a call to the
"fork()" system call to create a child process.  Open MPI is currently
operating in a condition that could result in memory corruption or
other system errors; your job may hang, crash, or produce silent
data corruption.  The use of fork() (or system() or other calls that
create child processes) is strongly discouraged.

The process that invoked fork was:

  Local host:          [[56711,1],0] (PID 17892)

If you are *absolutely sure* that your application will successfully
and correctly survive a call to fork(), you may disable this warning
by setting the mpi_warn_on_fork MCA parameter to 0.
--------------------------------------------------------------------------
-----------------------------------Parameters-----------------------------------
>>> model: racl-bert
>>> task: norec_fine
>>> batch_size: 8
>>> learning_rate: 0.0001
>>> kp1: 0.5
>>> kp2: 0.5
>>> reg_scale: 1e-05
>>> filter_num: 512
>>> class_num: 3
>>> load: 0
>>> max_sentence_len: 100
>>> n_iter: 15
>>> kernel_size: 3
>>> hop_num: 3
>>> warmup_iter: 10
>>> emb_dim: 1024
>>> data_path: data/norec_fine/
>>> train_path: data/norec_fine/train/
>>> test_path: data/norec_fine/test/
>>> dev_path: data/norec_fine/dev/


WARNING:tensorflow:From /cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /cluster/home/pmhalvor/nlp/msc/RACL/bert_modeling.py:652: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
WARNING:tensorflow:From /cluster/home/pmhalvor/nlp/msc/RACL/model_bert.py:501: conv1d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.conv1d instead.
Traceback (most recent call last):
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1659, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 768 and 1024 for 'layers_0/MatMul_4' (op: 'BatchMatMul') with input shapes: [?,100,768], [?,100,1024].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train_racl_bert.py", line 58, in <module>
    tf.app.run()
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "train_racl_bert.py", line 53, in main
    model.run()
  File "/cluster/home/pmhalvor/nlp/msc/RACL/model_bert.py", line 563, in run
    aspect_prob, opinion_prob, sentiment_prob = self.RACL_BERT(self.bert_input_ids, self.bert_input_mask, self.bert_segment_ids, self.position)
  File "/cluster/home/pmhalvor/nlp/msc/RACL/model_bert.py", line 528, in RACL_BERT
    word_see_context = tf.matmul((query[-1]), tf.nn.l2_normalize(context_conv, -1), adjoint_b=True)  * position_att
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py", line 2417, in matmul
    a, b, adj_x=adjoint_a, adj_y=adjoint_b, name=name)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/ops/gen_math_ops.py", line 1423, in batch_mat_mul
    "BatchMatMul", x=x, y=y, adj_x=adj_x, adj_y=adj_y, name=name)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 3300, in create_op
    op_def=op_def)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1823, in __init__
    control_input_ops)
  File "/cluster/software/TensorFlow/1.13.1-fosscuda-2019a-Python-3.7.2/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 1662, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 768 and 1024 for 'layers_0/MatMul_4' (op: 'BatchMatMul') with input shapes: [?,100,768], [?,100,1024].

Task and CPU usage stats:
       JobID    JobName  AllocCPUS   NTasks     MinCPU MinCPUTask     AveCPU    Elapsed ExitCode 
------------ ---------- ---------- -------- ---------- ---------- ---------- ---------- -------- 
4822507      pmhalvor/+          2                                             00:01:00      1:0 
4822507.bat+      batch          2        1   00:00:23          0   00:00:23   00:01:00      1:0 
4822507.ext+     extern          2        1   00:00:00          0   00:00:00   00:01:00      0:0 

Memory usage stats:
       JobID     MaxRSS MaxRSSTask     AveRSS MaxPages   MaxPagesTask   AvePages 
------------ ---------- ---------- ---------- -------- -------------- ---------- 
4822507                                                                          
4822507.bat+    134804K          0    134804K        0              0          0 
4822507.ext+          0          0          0        0              0          0 

Disk usage stats:
       JobID  MaxDiskRead MaxDiskReadTask    AveDiskRead MaxDiskWrite MaxDiskWriteTask   AveDiskWrite 
------------ ------------ --------------- -------------- ------------ ---------------- -------------- 
4822507                                                                                               
4822507.bat+       12.87M               0         12.87M        0.06M                0          0.06M 
4822507.ext+        0.00M               0          0.00M            0                0              0 

Job 4822507 completed at Wed Jan 12 22:29:05 CET 2022
